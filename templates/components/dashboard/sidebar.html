<!-- Mobile Menu Button -->
<button id="mobile-menu-button" 
        class="lg:hidden fixed top-6 left-6 z-50 p-3 rounded-xl bg-gray-800/90 backdrop-blur-lg text-white hover:bg-gray-700/90 transition-all duration-300 shadow-lg">
    <i class="fas fa-bars"></i>
</button>

<!-- Overlay -->
<div id="sidebar-overlay" 
     class="fixed inset-0 bg-black/60 backdrop-blur-sm z-40 lg:hidden hidden transition-all duration-300"></div>

<!-- Sidebar -->
<div id="sidebar" 
     class="fixed inset-y-0 left-0 w-[280px] bg-[#1E1F25] text-white flex flex-col z-50 transform -translate-x-full lg:translate-x-0 transition-all duration-300 shadow-2xl">
    <!-- Logo -->
    <div class="p-6">
        <a href="{{ url_for('main.landing') }}" class="block group">
            <h1 class="text-2xl font-bold text-white group-hover:text-primary transition-all duration-300 tracking-tight">
                <span class="text-primary bg-primary/10 px-2 py-1 rounded-lg">G</span>enerify
            </h1>
        </a>
    </div>
    
    <!-- Navigation -->
    <nav class="flex-1 px-4 py-4 overflow-y-auto">
        <div class="space-y-10">
            <!-- MAIN -->
            <div>
                <p class="px-3 text-xs font-semibold text-gray-400 uppercase tracking-wider mb-4">Main</p>
                <ul class="space-y-2">
                    <li>
                        <a href="{{ url_for('main.dashboard') }}" 
                           class="flex items-center px-4 py-3 text-sm font-medium text-gray-300 hover:text-white hover:bg-white/5 rounded-xl transition-all duration-300 group {% if request.endpoint == 'main.dashboard' %}bg-primary text-white{% endif %}">
                            <i class="fas fa-home w-5 h-5 transition-transform duration-300 group-hover:scale-110"></i>
                            <span class="ml-3">Dashboard</span>
                        </a>
                    </li>
                    <li>
                        <a href="{{ url_for('main.products') }}"
                           class="flex items-center px-4 py-3 text-sm font-medium text-gray-300 hover:text-white hover:bg-white/5 rounded-xl transition-all duration-300 group {% if request.endpoint == 'main.products' %}bg-primary text-white{% endif %}">
                            <i class="fas fa-box w-5 h-5 transition-transform duration-300 group-hover:scale-110"></i>
                            <span class="ml-3">Products</span>
                        </a>
                    </li>
                    <li>
                        <a href="{{ url_for('pages.analytics') }}"
                           class="flex items-center px-4 py-3 text-sm font-medium text-gray-300 hover:text-white hover:bg-white/5 rounded-xl transition-all duration-300 group {% if request.endpoint == 'pages.analytics' %}bg-primary text-white{% endif %}">
                            <i class="fas fa-chart-line w-5 h-5 transition-transform duration-300 group-hover:scale-110"></i>
                            <span class="ml-3">Analytics</span>
                        </a>
                    </li>
                </ul>
            </div>
            
            <!-- CONTENT -->
            <div>
                <p class="px-3 text-xs font-semibold text-gray-400 uppercase tracking-wider mb-4">Content</p>
                <ul class="space-y-2">
                    <li>
                        <a href="{{ url_for('main.ai_content') }}"
                           class="flex items-center px-4 py-3 text-sm font-medium text-gray-300 hover:text-white hover:bg-white/5 rounded-xl transition-all duration-300 group {% if request.endpoint == 'main.ai_content' %}bg-primary text-white{% endif %}">
                            <i class="fas fa-magic w-5 h-5 transition-transform duration-300 group-hover:scale-110"></i>
                            <span class="ml-3">AI Content</span>
                        </a>
                    </li>
                    <li>
                        <a href="{{ url_for('main.templates') }}"
                           class="flex items-center px-4 py-3 text-sm font-medium text-gray-300 hover:text-white hover:bg-white/5 rounded-xl transition-all duration-300 group {% if request.endpoint == 'main.templates' %}bg-primary text-white{% endif %}">
                            <i class="fas fa-file-alt w-5 h-5 transition-transform duration-300 group-hover:scale-110"></i>
                            <span class="ml-3">Templates</span>
                        </a>
                    </li>
                </ul>
            </div>
            
            <!-- SETTINGS -->
            <div>
                <p class="px-3 text-xs font-semibold text-gray-400 uppercase tracking-wider mb-4">Settings</p>
                <ul class="space-y-2">
                    <li>
                        <a href="{{ url_for('main.store_settings') }}"
                           class="flex items-center px-4 py-3 text-sm font-medium text-gray-300 hover:text-white hover:bg-white/5 rounded-xl transition-all duration-300 group {% if request.endpoint == 'main.store_settings' %}bg-primary text-white{% endif %}">
                            <i class="fas fa-store w-5 h-5 transition-transform duration-300 group-hover:scale-110"></i>
                            <span class="ml-3">Store Settings</span>
                        </a>
                    </li>
                    <li>
                        <a href="{{ url_for('main.account_settings') }}"
                           class="flex items-center px-4 py-3 text-sm font-medium text-gray-300 hover:text-white hover:bg-white/5 rounded-xl transition-all duration-300 group {% if request.endpoint == 'main.account_settings' %}bg-primary text-white{% endif %}">
                            <i class="fas fa-user-cog w-5 h-5 transition-transform duration-300 group-hover:scale-110"></i>
                            <span class="ml-3">Account</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    
    <!-- User Profile -->
    <div class="p-4 mt-auto">
        <div class="p-4 rounded-xl bg-white/5">
            <div class="flex items-center space-x-3">
                <!-- First Letter Avatar -->
                <div class="w-10 h-10 rounded-xl bg-primary flex items-center justify-center text-white font-medium text-lg">
                    {{ session.get('user', {}).get('first_name', 'U')[0] | upper }}
                </div>
                <div class="flex-1 min-w-0">
                    <p class="text-sm font-medium text-white truncate">
                        {{ session.get('user', {}).get('first_name', '') }} {{ session.get('user', {}).get('last_name', '') }}
                    </p>
                    <p class="text-xs text-gray-400">Store Owner</p>
                </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="mt-4 space-y-2">
                <!-- Sign Out Button -->
                <a href="{{ url_for('auth.logout') }}" 
                   class="flex items-center px-3 py-2.5 text-sm text-gray-300 hover:text-white hover:bg-white/5 rounded-lg transition-all duration-300 group">
                    <i class="fas fa-sign-out-alt w-5 h-5 transition-transform duration-300 group-hover:rotate-180"></i>
                    <span class="ml-3">Sign Out</span>
                </a>
                
                <!-- Help Link -->
                <a href="{{ url_for('main.help') }}" 
                   class="flex items-center px-3 py-2.5 text-sm text-gray-300 hover:text-white hover:bg-white/5 rounded-lg transition-all duration-300 group">
                    <i class="fas fa-question-circle w-5 h-5 transition-transform duration-300 group-hover:scale-110"></i>
                    <span class="ml-3">Help Center</span>
                </a>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebar-overlay');
        const menuButton = document.getElementById('mobile-menu-button');
        let isSidebarOpen = false;

        function toggleSidebar() {
            isSidebarOpen = !isSidebarOpen;
            if (isSidebarOpen) {
                sidebar.classList.remove('-translate-x-full');
                overlay.classList.remove('hidden');
                document.body.classList.add('overflow-hidden');
            } else {
                sidebar.classList.add('-translate-x-full');
                overlay.classList.add('hidden');
                document.body.classList.remove('overflow-hidden');
            }
        }

        menuButton.addEventListener('click', toggleSidebar);
        overlay.addEventListener('click', toggleSidebar);

        // Close sidebar on navigation
        const navLinks = sidebar.querySelectorAll('a');
        navLinks.forEach(link => {
            link.addEventListener('click', () => {
                if (window.innerWidth < 1024) { // lg breakpoint
                    toggleSidebar();
                }
            });
        });

        // Handle resize
        window.addEventListener('resize', () => {
            if (window.innerWidth >= 1024 && isSidebarOpen) {
                toggleSidebar();
            }
        });

        // Handle swipe gestures
        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
        }, false);

        document.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }, false);

        function handleSwipe() {
            const swipeThreshold = 50;
            const swipeDistance = touchEndX - touchStartX;

            if (Math.abs(swipeDistance) < swipeThreshold) return;

            if (swipeDistance > 0 && !isSidebarOpen) { // Right swipe
                toggleSidebar();
            } else if (swipeDistance < 0 && isSidebarOpen) { // Left swipe
                toggleSidebar();
            }
        }
    });
</script> 