<!-- Mobile Menu Button -->
<button id="mobile-menu-button">
    <i class="fas fa-bars"></i>
</button>

<!-- Overlay -->
<div id="sidebar-overlay" class="hidden"></div>

<!-- Sidebar -->
<div id="sidebar">
    <!-- Logo -->
    <div class="logo-section">
        <a href="{{ url_for('main.landing') }}" class="block group">
            <h1>
                <span class="logo-highlight">G</span>enerify
            </h1>
        </a>
    </div>
    
    <!-- Navigation -->
    <nav>
        <div class="space-y-10">
            <!-- MAIN -->
            <div>
                <p class="nav-section-header">Main</p>
                <ul class="space-y-2">
                    <li>
                        <a href="{{ url_for('main.dashboard') }}" 
                           class="nav-link {% if request.endpoint in ['main.dashboard', 'pages.dashboard'] %}active{% endif %}">
                            <i class="fas fa-home"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li>
                        <a href="{{ url_for('main.products') }}"
                           class="nav-link {% if request.endpoint == 'main.products' %}active{% endif %}">
                            <i class="fas fa-box"></i>
                            <span>Products</span>
                        </a>
                    </li>
                    <li>
                        <a href="{{ url_for('pages.analytics') }}"
                           class="nav-link {% if request.endpoint == 'pages.analytics' %}active{% endif %}">
                            <i class="fas fa-chart-line"></i>
                            <span>Analytics</span>
                        </a>
                    </li>
                </ul>
            </div>
            
            <!-- CONTENT -->
            <div>
                <p class="nav-section-header">Content</p>
                <ul class="space-y-2">
                    <li>
                        <a href="{{ url_for('main.ai_content') }}"
                           class="nav-link {% if request.endpoint == 'main.ai_content' %}active{% endif %}">
                            <i class="fas fa-magic"></i>
                            <span>AI Content</span>
                        </a>
                    </li>
                    <li>
                        <a href="{{ url_for('main.templates') }}"
                           class="nav-link {% if request.endpoint == 'main.templates' %}active{% endif %}">
                            <i class="fas fa-file-alt"></i>
                            <span>Templates</span>
                        </a>
                    </li>
                </ul>
            </div>
            
            <!-- SETTINGS -->
            <div>
                <p class="nav-section-header">Settings</p>
                <ul class="space-y-2">
                    <li>
                        <a href="{{ url_for('main.store_settings') }}"
                           class="nav-link {% if request.endpoint == 'main.store_settings' %}active{% endif %}">
                            <i class="fas fa-store"></i>
                            <span>Store Settings</span>
                        </a>
                    </li>
                    <li>
                        <a href="{{ url_for('main.account_settings') }}"
                           class="nav-link {% if request.endpoint == 'main.account_settings' %}active{% endif %}">
                            <i class="fas fa-user-cog"></i>
                            <span>Account</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    
    <!-- User Profile -->
    <div class="user-profile">
        <div class="user-profile-content">
            <div class="user-info">
                <!-- First Letter Avatar -->
                <div class="user-avatar">
                    {{ session.get('user', {}).get('first_name', 'U')[0] | upper }}
                </div>
                <div class="user-details">
                    <p class="user-name">
                        {{ session.get('user', {}).get('first_name', '') }} {{ session.get('user', {}).get('last_name', '') }}
                    </p>
                    <p class="user-role">Store Owner</p>
                </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="quick-actions">
                <!-- Sign Out Button -->
                <a href="{{ url_for('auth.logout') }}" class="quick-action-link">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Sign Out</span>
                </a>
                
                <!-- Help Link -->
                <a href="{{ url_for('main.help') }}" class="quick-action-link">
                    <i class="fas fa-question-circle"></i>
                    <span>Help Center</span>
                </a>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebar-overlay');
        const menuButton = document.getElementById('mobile-menu-button');
        let isSidebarOpen = false;

        function toggleSidebar() {
            isSidebarOpen = !isSidebarOpen;
            if (isSidebarOpen) {
                sidebar.classList.remove('-translate-x-full');
                overlay.classList.remove('hidden');
                document.body.classList.add('overflow-hidden');
            } else {
                sidebar.classList.add('-translate-x-full');
                overlay.classList.add('hidden');
                document.body.classList.remove('overflow-hidden');
            }
        }

        menuButton.addEventListener('click', toggleSidebar);
        overlay.addEventListener('click', toggleSidebar);

        // Close sidebar on navigation
        const navLinks = sidebar.querySelectorAll('a');
        navLinks.forEach(link => {
            link.addEventListener('click', () => {
                if (window.innerWidth < 1024) { // lg breakpoint
                    toggleSidebar();
                }
            });
        });

        // Handle resize
        window.addEventListener('resize', () => {
            if (window.innerWidth >= 1024 && isSidebarOpen) {
                toggleSidebar();
            }
        });

        // Handle swipe gestures
        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
        }, false);

        document.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }, false);

        function handleSwipe() {
            const swipeThreshold = 50;
            const swipeDistance = touchEndX - touchStartX;

            if (Math.abs(swipeDistance) < swipeThreshold) return;

            if (swipeDistance > 0 && !isSidebarOpen) { // Right swipe
                toggleSidebar();
            } else if (swipeDistance < 0 && isSidebarOpen) { // Left swipe
                toggleSidebar();
            }
        }
    });
</script> 